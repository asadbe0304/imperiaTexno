(window.webpackJsonp=window.webpackJsonp||[]).push([[133],{1220:function(e,t,o){"use strict";o.r(t);o(10);var r=o(4),n=o(5),c=(o(35),o(8)),d=o(3);function l(object,e){var t=Object.keys(object);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(object);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(object,e).enumerable}))),t.push.apply(t,o)}return t}function h(e){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?l(Object(source),!0).forEach((function(t){Object(n.a)(e,t,source[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(source)):l(Object(source)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(source,t))}))}return e}var m={mixins:[o(13).a],computed:h(h(h({},Object(c.e)({wasLocated:e=>e.wasLocated,zones:e=>e.zones,geolocation:e=>e.configurations.geolocation})),Object(c.c)({defaultZone:"getDefaultZone",visitorCookieDuration:"visitorCookieDuration"})),{},{oldGeoProvider(){var e=this.geolocation.find((e=>"GEO_SERVICE"===e.key));return e?e.value.value:"google"},newGeoEnabled(){var e=this.geolocation.find((e=>"GEOCODE_NEW_ENABLED"===e.key));return!!e&&e.value.value},isGeocoderEnabled(){var e=this.geolocation.find((e=>"GEOCODE_ENABLED"===e.key));return!!e&&e.value.value}}),mounted(){"rus"!==this.selectedZone.slug&&(this.$cookies.get(d.e)&&this.$store.commit("SET_LOCATED_ZONE",this.selectedZone),this.$cookies.get(d.h)||this.geoFindMe())},methods:{geoFindMe(){this.isGeocoderEnabled?this.isGeocoderEnabled&&navigator.geolocation?navigator.geolocation.getCurrentPosition(this.success,this.error):this.isGeocoderEnabled&&!navigator.geolocation&&(this.$store.commit("SET_UNLOCATED_ZONE",!0),this.$yaMetrikaReachGoal("dontKnowRegion")):(this.setLocated(),this.setLocatedShow(!0))},success(e){this.setLocated();var t=e.coords.latitude,o=e.coords.longitude;this.newGeoEnabled?this.newGeocoderRequest(o,t):"google"===this.oldGeoProvider?this.googleGeocoderRequest(o,t):"yandex"===this.oldGeoProvider&&this.yandexGeocoderRequest(o,t)},error(){this.setLocated(),setTimeout((()=>{this.$store.commit("SET_UNLOCATED_ZONE",!0),this.$yaMetrikaReachGoal("dontKnowRegion")}),500)},setLocated(){this.$cookies.set(d.h,!0,{path:"/",domain:".".concat("imperiatechno.ru"),maxAge:this.visitorCookieDuration})},googleGeocoderRequest(e,t){this.$axios({url:"https://maps.googleapis.com/maps/api/geocode/json",params:{key:"AIzaSyBezG23RMOlsNGkqcLwRb6GD97602dHzUQ",language:"ru",latlng:"".concat(t,",").concat(e)}}).then((e=>{e.data.results.map((e=>{var t=[];e.address_components.map((component=>{component.types.includes("political")&&t.push(component.long_name,component.short_name)})),this.getFilteredZones.find((e=>e.geo_names.find((o=>{if(t.includes(o))return this.setRedirect(e),!0}))))||(this.$store.commit("SET_UNLOCATED_ZONE",!0),this.$yaMetrikaReachGoal("dontKnowRegion"))}))})).catch((e=>{this.$logError(e),this.$store.commit("SET_UNLOCATED_ZONE",!0),this.$yaMetrikaReachGoal("dontKnowRegion")}))},yandexGeocoderRequest(e,t){this.$axios({url:"https://geocode-maps.yandex.ru/1.x",params:{apikey:"07308e2b-ab86-44ae-990b-7b203c2c633d",format:"json",geocode:[e,t].toString()}}).then((e=>{var t=e.data.response.GeoObjectCollection.featureMember[0].GeoObject.metaDataProperty.GeocoderMetaData.AddressDetails.Country.AdministrativeArea,o=t.SubAdministrativeArea,r=[t.AdministrativeAreaName];o&&(o.SubAdministrativeAreaName&&r.push(o.SubAdministrativeAreaName),o.Locality&&o.Locality.LocalityName&&r.push(o.Locality.LocalityName)),this.getFilteredZones.find((e=>e.geo_names.find((t=>{if(r.includes(t))return this.setRedirect(e),!0}))))||(this.$store.commit("SET_UNLOCATED_ZONE",!0),this.$yaMetrikaReachGoal("dontKnowRegion"))})).catch((e=>{this.$logError(e),this.$store.commit("SET_UNLOCATED_ZONE",!0),this.$yaMetrikaReachGoal("dontKnowRegion")}))},newGeocoderRequest(e,t){var o=this;return Object(r.a)((function*(){try{var r=yield o.$sendRequest({url:"/geocoder",method:"get",params:{latitude:t,longitude:e,cached:1}});if(r.data.geocoder.length>0){var n=[];r.data.geocoder.map((e=>{n.push(e.locality,e.street_name),Array.isArray(e.admin_levels)&&n.push(...e.admin_levels)})),o.getFilteredZones.find((e=>e.geo_names.find((t=>{if(n.includes(t))return o.setRedirect(e),!0}))))||(o.$store.commit("SET_UNLOCATED_ZONE",!0),o.$yaMetrikaReachGoal("dontKnowRegion"))}else o.$store.commit("SET_UNLOCATED_ZONE",!0),o.$yaMetrikaReachGoal("dontKnowRegion")}catch(e){o.$logError(e),o.$store.commit("SET_UNLOCATED_ZONE",!0),o.$yaMetrikaReachGoal("dontKnowRegion")}}))()},setRedirect(e){"rus"!==e.slug&&this.$cookies.set(d.e,!0,{path:"/",domain:".".concat("imperiatechno.ru")}),this.setZone(e)}},render:()=>""},E=m,O=o(1),component=Object(O.a)(E,undefined,undefined,!1,null,null,null);t.default=component.exports}}]);